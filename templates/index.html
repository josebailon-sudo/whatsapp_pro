{% extends "base.html" %}

{% block content %}

<!-- Bienvenida y Elecci√≥n de Modo -->
<div class="text-center mb-5">
    <h1 class="display-4 fw-bold text-success mb-3">
        <i class="bi bi-whatsapp"></i> ¬°Bienvenido a WhatsApp Pro!
    </h1>
    <p class="lead text-muted mb-4">Sistema de mensajer√≠a masiva profesional</p>
    
    {% if show_wizard_suggestion %}
    <div class="alert alert-info alert-dismissible fade show" role="alert">
        <i class="bi bi-lightbulb-fill"></i> <strong>¬øPrimera vez aqu√≠?</strong> 
        Te recomendamos usar el <strong>Asistente Paso a Paso</strong> para configurar todo f√°cilmente.
        <a href="?mode=expert" class="alert-link">O continuar al panel completo si ya sabes lo que haces</a>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    {% elif total_contacts > 0 %}
    <div class="alert alert-success">
        <i class="bi bi-check-circle-fill"></i> Sistema listo: <strong>{{ total_contacts }} contactos</strong> cargados. 
        <a href="{% url 'wizard_welcome' %}" class="alert-link">Usar asistente paso a paso</a>
    </div>
    {% endif %}
</div>

<!-- Dos opciones principales -->
<div class="row g-4 mb-5">
    <!-- OPCI√ìN 1: ASISTENTE GUIADO -->
    <div class="col-lg-6">
        <div class="card shadow-lg border-0 h-100" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
            <div class="card-body text-center text-white p-5">
                <i class="bi bi-signpost-2-fill display-1 mb-4"></i>
                <h2 class="fw-bold mb-3">üéØ ASISTENTE PASO A PASO</h2>
                <p class="fs-5 mb-4">
                    Te guiamos en todo el proceso:<br>
                    <small class="d-block mt-3">
                        ‚ë† Importar contactos<br>
                        ‚ë° Crear mensaje<br>
                        ‚ë¢ Conectar WhatsApp<br>
                        ‚ë£ Configurar env√≠o<br>
                        ‚ë§ Lanzar campa√±a
                    </small>
                </p>
                <a href="{% url 'wizard_welcome' %}" class="btn btn-light btn-lg px-5 shadow-lg">
                    <i class="bi bi-play-circle-fill"></i> Comenzar Gu√≠a
                </a>
                <p class="mt-3 mb-0">
                    <small><i class="bi bi-lightbulb-fill"></i> Ideal para principiantes</small>
                </p>
            </div>
        </div>
    </div>

    <!-- OPCI√ìN 2: MODO AVANZADO -->
    <div class="col-lg-6">
        <div class="card shadow-lg border-0 h-100" style="background: linear-gradient(135deg, #4568dc 0%, #b06ab3 100%);">
            <div class="card-body text-center text-white p-5">
                <i class="bi bi-lightning-charge-fill display-1 mb-4"></i>
                <h2 class="fw-bold mb-3">‚ö° MODO AVANZADO</h2>
                <p class="fs-5 mb-4">
                    T√∫ decides el orden y qu√© hacer:<br>
                    <small class="d-block mt-3">
                        ‚Ä¢ Acceso directo a todas las funciones<br>
                        ‚Ä¢ Sin restricciones<br>
                        ‚Ä¢ M√°xima flexibilidad<br>
                        ‚Ä¢ Para usuarios experimentados
                    </small>
                </p>
                <button class="btn btn-light btn-lg px-5 shadow-lg" onclick="document.getElementById('quickActions').scrollIntoView({behavior: 'smooth'})">
                    <i class="bi bi-grid-3x3-gap-fill"></i> Ver Panel Completo
                </button>
                <p class="mt-3 mb-0">
                    <small><i class="bi bi-gear-fill"></i> Control total</small>
                </p>
            </div>
        </div>
    </div>
</div>

<hr class="my-5">

<!-- Panel de Acciones R√°pidas (Modo Avanzado) -->
<div id="quickActions">
<h2 class="text-center mb-4 fw-bold">Acciones R√°pidas</h2>
<div class="row mb-4">
  <div class="col-12">
    <h2><i class="bi bi-house-door"></i> Bienvenido a WhatsApp Pro</h2>
    <p class="lead">Panel de administraci√≥n para campa√±as de mensajer√≠a masiva</p>
  </div>
</div>

<!-- Acciones Principales Destacadas -->
<div class="row g-3 mb-5">
  <!-- ENV√çO R√ÅPIDO -->
  <div class="col-md-4">
    <a href="{% url 'quick_send' %}" class="text-decoration-none">
      <div class="card shadow-lg border-0 h-100" style="background: linear-gradient(135deg, #FFC107 0%, #FF9800 100%);">
        <div class="card-body text-center text-white p-4">
          <i class="bi bi-lightning-charge-fill display-1 mb-3"></i>
          <h2 class="fw-bold">‚ö° ENV√çO R√ÅPIDO</h2>
          <p class="fs-6 mb-4">Escribe y env√≠a ahora sin guardar plantilla</p>
          <button class="btn btn-light btn-lg px-4">
            <i class="bi bi-send-fill"></i> Enviar Ahora
          </button>
        </div>
      </div>
    </a>
  </div>
  
  <!-- DISE√ëAR MENSAJE -->
  <div class="col-md-4">
    <a href="{% url 'template_create' %}" class="text-decoration-none">
      <div class="card shadow-lg border-0 h-100" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div class="card-body text-center text-white p-4">
          <i class="bi bi-file-earmark-text display-1 mb-3"></i>
          <h2 class="fw-bold">DISE√ëAR MENSAJE</h2>
          <p class="fs-6 mb-4">Crea plantillas reutilizables con variables</p>
          <button class="btn btn-light btn-lg px-4">
            <i class="bi bi-plus-circle"></i> Crear Plantilla
          </button>
        </div>
      </div>
    </a>
  </div>
  
  <!-- CREAR CAMPA√ëA -->
  <div class="col-md-4">
    <a href="{% url 'campaign_create' %}" class="text-decoration-none">
      <div class="card shadow-lg border-0 h-100" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
        <div class="card-body text-center text-white p-4">
          <i class="bi bi-megaphone-fill display-1 mb-3"></i>
          <h2 class="fw-bold">CREAR CAMPA√ëA</h2>
          <p class="fs-6 mb-4">Campa√±as masivas con filtros avanzados</p>
          <button class="btn btn-light btn-lg px-4">
            <i class="bi bi-send"></i> Nueva Campa√±a
          </button>
        </div>
      </div>
    </a>
  </div>
</div>

<div class="row g-3 mb-4">
  <div class="col-md-3">
    <div class="card stats-card border-primary">
      <div class="card-body text-center">
        <i class="bi bi-people fs-1 text-primary"></i>
        <h3 class="mt-2">{{ total_contacts }}</h3>
        <p class="text-muted mb-0">Contactos</p>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card stats-card border-success">
      <div class="card-body text-center">
        <i class="bi bi-file-text fs-1 text-success"></i>
        <h3 class="mt-2">{{ total_templates }}</h3>
        <p class="text-muted mb-0">Plantillas Activas</p>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card stats-card border-info">
      <div class="card-body text-center">
        <i class="bi bi-megaphone fs-1 text-info"></i>
        <h3 class="mt-2">{{ total_campaigns }}</h3>
        <p class="text-muted mb-0">Campa√±as</p>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card stats-card border-warning">
      <div class="card-body text-center">
        <i class="bi bi-clock-history fs-1 text-warning"></i>
        <h3 class="mt-2">{{ pending_messages }}</h3>
        <p class="text-muted mb-0">Mensajes Pendientes</p>
      </div>
    </div>
  </div>
</div>

<div class="row g-3 mb-4">
  <div class="col-md-3">
    <div class="card stats-card border-secondary">
      <div class="card-body text-center">
        <i class="bi bi-tags fs-1 text-secondary"></i>
        <h3 class="mt-2">{{ total_tags }}</h3>
        <p class="text-muted mb-0">Etiquetas</p>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card stats-card border-danger">
      <div class="card-body text-center">
        <i class="bi bi-robot fs-1 text-danger"></i>
        <h3 class="mt-2">{{ active_rules }}</h3>
        <p class="text-muted mb-0">Reglas Activas</p>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card stats-card border-dark">
      <div class="card-body text-center">
        <i class="bi bi-diagram-3 fs-1 text-dark"></i>
        <h3 class="mt-2">{{ active_workflows }}</h3>
        <p class="text-muted mb-0">Workflows Activos</p>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card stats-card border-primary">
      <div class="card-body text-center">
        <i class="bi bi-calendar-check fs-1 text-primary"></i>
        <h3 class="mt-2">{{ pending_followups }}</h3>
        <p class="text-muted mb-0">Seguimientos Pendientes</p>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-6 mb-4">
    <div class="card h-100">
      <div class="card-header bg-success text-white">
        <i class="bi bi-info-circle"></i> C√≥mo Empezar
      </div>
      <div class="card-body">
        <ol class="mb-0">
          <li class="mb-2">
            <strong>Importa contactos:</strong> Usa el comando
            <code>python manage.py import_contacts archivo.csv</code>
          </li>
          <li class="mb-2">
            <strong>Crea plantillas:</strong> En el <a href="/admin/whatsapp/template/">Admin</a>,
            usa variables como {nombre}, {telefono}, {grupo}
          </li>
          <li class="mb-2">
            <strong>Configura etiquetas:</strong> Organiza contactos con <a href="{% url 'tags_list' %}">etiquetas</a>
          </li>
          <li class="mb-2">
            <strong>Crea campa√±as:</strong> Asigna una plantilla y encola mensajes
          </li>
          <li class="mb-0">
            <strong>Ejecuta el worker:</strong>
            <code>python manage.py run_worker</code> para procesar env√≠os
          </li>
        </ol>
      </div>
    </div>
  </div>
  
  <div class="col-md-6 mb-4">
    <div class="card h-100">
      <div class="card-header bg-info text-white">
        <i class="bi bi-link-45deg"></i> Enlaces R√°pidos
      </div>
      <div class="card-body">
        <div class="row g-2">
          <div class="col-6">
            <a href="{% url 'contacts_list' %}" class="btn btn-outline-primary w-100">
              <i class="bi bi-people"></i> Contactos
            </a>
          </div>
          <div class="col-6">
            <a href="{% url 'templates_list' %}" class="btn btn-outline-success w-100">
              <i class="bi bi-file-text"></i> Plantillas
            </a>
          </div>
          <div class="col-6">
            <a href="{% url 'campaigns_list' %}" class="btn btn-outline-info w-100">
              <i class="bi bi-megaphone"></i> Campa√±as
            </a>
          </div>
          <div class="col-6">
            <a href="{% url 'tags_list' %}" class="btn btn-outline-secondary w-100">
              <i class="bi bi-tags"></i> Etiquetas
            </a>
          </div>
          <div class="col-6">
            <a href="{% url 'rules_list' %}" class="btn btn-outline-danger w-100">
              <i class="bi bi-robot"></i> Reglas Auto
            </a>
          </div>
          <div class="col-6">
            <a href="{% url 'workflows_list' %}" class="btn btn-outline-dark w-100">
              <i class="bi bi-diagram-3"></i> Workflows
            </a>
          </div>
          <div class="col-6">
            <a href="{% url 'followups_list' %}" class="btn btn-outline-warning w-100">
              <i class="bi bi-calendar-check"></i> Seguimientos
            </a>
          </div>
          <div class="col-6">
            <a href="{% url 'analytics' %}" class="btn btn-outline-primary w-100">
              <i class="bi bi-graph-up"></i> Anal√≠ticas
            </a>
          </div>
          <div class="col-6">
            <a href="/admin/" class="btn btn-outline-secondary w-100">
              <i class="bi bi-gear"></i> Admin
            </a>
          </div>
          <div class="col-6">
            <a href="/api/" class="btn btn-outline-dark w-100">
              <i class="bi bi-code-slash"></i> API REST
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
